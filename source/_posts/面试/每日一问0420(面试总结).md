---
title:
tags:
  - 简历
---


#  面试总结

## 面试步骤
### 自我介绍

以下几点要素

1. 几句简单话介绍自己主要的技术栈于擅长的领域

   领域:电商,车联网 服务治理(CI/CD,监控与报警,调用链,限流,熔断,降级,连接复用(连接池),配置优化,故障定位,提高资源利用率)



## 遇到的问题

生产环境白天 mysql 加字段，有些请求超时问题排查；MDL锁





自己总结

### 业务介绍

千方科技 工作内容 
这家公司是做交通大数据的，就是在各个交通路口 有很多的信息采集设备，比如摄像头，雷达 等等
比如我现在在做的一个项目(物联网IOT平台)，是对接华为的雷达设备数据。 我们整体是一个云边端的架构。在我们公司有
自己的服务器，搭建了公司的私有云和公有云并对外提供服务，然后在各个路口，可能多个路口中有一个在一边会部署我们的ECU硬件边设备。
这个设备用来对接雷达，摄像头等多种端设备数据，并将数据汇总上报到云端。
我这个需求对接的是华为的雷达设备，它会实时采集路口的车辆信息事件，比如拥堵，车辆行驶方向,路口当前相位，车辆事故等事件。
它通过kafka来生产事件，发送到我们边端IOT平台来进行消费（边端IOT平台部署在边端ECU上，硬件资源有限）。一个IOT平台可以对接多个端设备。数据处理后同步到云端IOT平台的消息总线，EMQ中进行广播，下游第三方可以订阅接入事件来进行根据交通事件做二次开发。
现在出现了一个问题，华为的雷达数据大概每秒30W的事件，由于上报是持续实时的，消费高峰来临，事件延迟特别高，有的达到30秒的延迟。我接到这个需求要进行调优。将一个事件整个链路优化到一秒内。
然后开始排查原因：我们的IOT平台是一个同样的设备数据接入平台，整体是k8s容器化部署的，设备数据管理和数据接入是两个模块，两个容器部署的，为了实现通用性，设计上用了适配器模式，当前支持TCP，UDP，restAPI,消息队列 等； 当有新的类型设备接入的时候，他会新研发一个适配器的模块就是通过集成实现adapter的方式，然后通过反射的方式 将新适配器对象加载进来，在适配器容器主进程中启动一个子线程来运行这个适配器实例。这样就存在一个问题。由于是容器化部署。
容器会加载多种类型的适配器启动多个线程共享一个容器的资源，这个适配器是动态加载的，容器资源不好直接扩充，当有这种高并发的大数据流会造成CPU，内存资源不足，有时会出现OOM。
为了解决这个问题，首先讨论了一个最佳方案： 就是不通过反射，而是用启动新容器的方式，将每种适配器通过容器将资源分开。但由于架构设计上的原因，边设备上的所有配置是由云端统一下发的，现在没办法控制每个适配器容器资源。
所以采用第二种方案。在现有架构基础上 优化整个链路。

所做的事情 
1.  kafka 集群的调优 主要是根据当时的吞吐量 根据kafka的压测脚本 压测一个最佳的 broker ，分区数量。然后在消费端起相应分区数量的消费者，来达到负载均衡最高。
2. 再有为了减少网络之间的多次IO，我们进行打包压缩发送，批量拉取消息。每次拉取500条。
3. 消费端启动多线程来进行并发的数据处理，多线程参数调优
4. 写了一个模拟数据的脚本，对消费端程序进行压测；压测的批次分别5W，10W，15W，20W条，每条事件添加创建和消费各个阶段的时间埋点。
发现前期5w,10w基本上每条消息延迟大概一个线性增长。这种情况 就进行多线程核心线程数，最大线程数，阻塞队列的调优。
后面发现数据量超过10W以后延迟时间接近指数上涨。每增大一个批次，最大延迟有30秒，然后就在多线程的每个线程的异步处理多个事件的地方增加了cutdownlanch，来控制程序的最大并发量，
5. 还有一级二级缓存啊
6. 重复消费，消息乱序的处理。
7. EMQ端也进行压测 进行参数调优。


敏捷云系统
敏捷云系统 基于kubercontrol API ,搭建了公司的私有化云平台和公有云平台，harbor镜像 和二进制制品 公有云私有云打通。大镜像包的追加镜像构建。
在敏捷云系统中研发人员可以快速构建代码库，生产制品，部署发布到任何集群。在集群中有可以管控容器的生命周期，环境变量，容器的CPU内存监控，日志采集，异常报警等等。


小红唇

订单系统模块的重构，
原因 是由于订单模块是电商系统核心模块，更新迭代特别快，掺杂了很多复杂的业务。

a. 使新产品迭代开发效率很低。
b. 再有核心模块的复杂也造成了订单响应速度比较慢，在双十一11点秒杀，

c. 拼团这种高并发场景经常会出现一些问题。
d. 还有订单原有架构不能支撑更细粒度的退款。
针对这四点 做了以下改动  

a. 

1）通过使用设计模式进行封装，使用的设计模式有，抽象工厂模式（场景:）,责任链模式(下单命中活动任务)，单例模式，代理模式，进行抽象解耦，模板方法模式

2）微服务下沉, 根据sku,spu 抽离出商品微服务，优惠券微服务，活动微服务

3）公共中间件封装，统一异常处理，封装，

b.

1）响应速度慢采用 将复杂模块一步解耦，引入消息总线，eventBus, 将下单各个节点推送事物比如下单拆单过程，下单发积分返利，下单推物流，下单海外仓商品报关 ，

2）redis 缓存，处理扣库存逻辑

3）RocketMQ 延迟队列处理 秒杀场景，前端异步刷新秒杀结果

c. 根据elk 做的增加了监控报警， 短信，钉钉提醒，

d.

1万条；

es kibana —_version 干嘛的
es 删除

mysql  

建了 索引；10几亿的数据。MDL锁；写入比较频繁， redolog 脏页；

自增ID；int





 吹牛逼：
 日交易额达到3000万 单台服务瞬时流量达到了QPS3000+

 8台微服务，内存保持在70%， CPU维持在80%

 商城基本操作请求响应时间都在一秒内完成。 部分并发情况引起的延迟最多15秒响应，
 处理了高并发场景线程堆积问题，

 1. 首先项目是做啥的，有啥业绩
 2. 我们项目的复杂性是什么，我遇到的几个例子
 3. 我的总结，体现我的举一反三的能力


 1. 看过的某个电影
 2. 介绍认识的某个明星（经历，特点，我为什么喜欢他，等等）
 3. 科技上的某个新兴领域
 4. 某个神奇的知识点
 5. 介绍穿搭的心得体会，心路历程

 定义子问题
 写出子问题的地推关系
 确定DP数组的计算顺序
 空间优化（可选）